"use strict";(self.webpackChunkdeal_crm=self.webpackChunkdeal_crm||[]).push([[975],{2913:(e,t,s)=>{s.d(t,{A:()=>i});var a=s(5043),c=s(9853),n=s(4282),r=s(714),o=s(579);const i=e=>{let{id:t,note:s,filterHouses:i}=e;const{changeNote:d}=(0,r.j)(),[l,h]=(0,a.useState)(s);return(0,o.jsxs)(c.A,{children:[(0,o.jsx)(c.A.Group,{controlId:"noteText",children:(0,o.jsx)(c.A.Control,{as:"textarea",rows:3,placeholder:"Input note...",value:l,onChange:e=>h(e.target.value)})}),(0,o.jsx)(n.A,{variant:"primary",className:"mt-2",onClick:async()=>{await d(t,l),i()},children:"Save"})]})}},5975:(e,t,s)=>{s.r(t),s.d(t,{default:()=>j});var a=s(5043),c=s(3519),n=s(4196),r=s(9853),o=s(8628),i=s(9204),d=s(807),l=s(714),h=s(9657),u=s(9002),m=s(2913),x=s(579);const j=()=>{const{statuses:e,fetchStatuses:t}=(0,i.X)(),{user:s,fetchUser:j}=(0,d.k)(),{housesFiltered:g,fetchFilterHouses:p,changeStatus:_}=(0,l.j)(),y=(new Date).toISOString().slice(0,10),w=(0,h.Ub)({maxWidth:767});g.sort(((e,t)=>new Date(e.target_date).getTime()-new Date(t.target_date).getTime()));const f={};for(const a of g){const e=a.target_date.slice(0,10);f[e]||(f[e]=[]),f[e].push(a)}(0,a.useEffect)((()=>{t(),j(2),A()}),[]);const A=()=>{p("","","2","","",y)};return(0,x.jsxs)(c.A,{children:[(0,x.jsx)("h1",{children:"Dashboard"}),(0,x.jsx)("hr",{}),(0,x.jsx)("h4",{children:s.name}),w?Object.entries(f).map((t=>{let[s,a]=t;return(0,x.jsxs)("div",{children:[(0,x.jsx)("h5",{children:s}),(0,x.jsx)(x.Fragment,{children:a.map((t=>(0,x.jsx)(o.A,{className:"mb-2",children:(0,x.jsxs)(o.A.Body,{children:[(0,x.jsxs)("div",{children:[(0,x.jsxs)("b",{children:["Lot ",t.house_name]}),(0,x.jsxs)("div",{className:"d-block",children:[(0,x.jsx)(u.N_,{className:"me-2",to:"/companies/".concat(t.company_id,"/").concat(t.construction_id),children:t.construction_name}),(0,x.jsx)("i",{children:(0,x.jsxs)(u.N_,{to:"/companies/".concat(t.company_id,"/").concat(t.construction_id,"/").concat(t.plan_id),children:["(",t.plan_name,")"]})})]})]}),t.street&&t.city&&t.zip_code&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("hr",{}),(0,x.jsx)("span",{className:"text-start me-2 d-block",children:"Address:"}),(0,x.jsxs)("a",{href:"https://www.google.com/maps/search/?api=1&query=".concat(encodeURIComponent("".concat(t.street," ").concat(t.unit,", ").concat(t.city,", ").concat(t.state," ").concat(t.zip_code,", USA"))),target:"_blank",rel:"noopener noreferrer",children:[t.street," ",t.unit,", ",t.city,", ",t.state," ",t.zip_code,", USA"]})]}),(0,x.jsx)("hr",{}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"me-1",children:"Type Of Work:"}),t.type_of_work_name]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("span",{className:"d-block",children:"Status:"}),(0,x.jsx)(r.A.Select,{required:!0,name:"status_id",style:{backgroundColor:t.status_color,color:"white"},onChange:async e=>{const s=e.target.value;await _(t.id,s),A()},children:e.map((e=>(0,x.jsx)("option",{style:{backgroundColor:e.color},selected:e.id===t.status_id,value:e.id,children:e.name})))})]}),(0,x.jsx)("hr",{}),(0,x.jsx)("div",{children:(0,x.jsx)(m.A,{id:t.id,note:t.note,filterHouses:A})})]})},t.id)))})]},s)})):Object.entries(f).map((t=>{let[s,a]=t;return(0,x.jsxs)("div",{children:[(0,x.jsx)("h5",{children:s}),(0,x.jsxs)(n.A,{striped:!0,bordered:!0,hover:!0,responsive:"sm",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"#"}),(0,x.jsx)("th",{className:"text-start",children:"House"}),(0,x.jsx)("th",{className:"text-start",children:"Type Of work"}),(0,x.jsx)("th",{children:"Status"}),(0,x.jsx)("th",{children:"Note"})]})}),(0,x.jsx)("tbody",{children:a.map((t=>(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{className:"align-middle",children:t.house_id}),(0,x.jsxs)("td",{className:"text-start align-middle w-25",children:[(0,x.jsxs)("b",{children:["Lot ",t.house_name]}),(0,x.jsxs)("div",{className:"d-block",children:[(0,x.jsx)(u.N_,{className:"me-2",to:"/companies/".concat(t.company_id,"/").concat(t.construction_id),children:t.construction_name}),(0,x.jsx)("i",{children:(0,x.jsxs)(u.N_,{to:"/companies/".concat(t.company_id,"/").concat(t.construction_id,"/").concat(t.plan_id),children:["(",t.plan_name,")"]})})]}),t.street&&t.city&&t.zip_code&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("hr",{}),(0,x.jsx)("span",{className:"text-start me-2 d-block",children:"Address:"}),(0,x.jsxs)("a",{href:"https://www.google.com/maps/search/?api=1&query=".concat(encodeURIComponent("".concat(t.street," ").concat(t.unit,", ").concat(t.city,", ").concat(t.state," ").concat(t.zip_code,", USA"))),target:"_blank",rel:"noopener noreferrer",children:[t.street," ",t.unit,", ",t.city,", ",t.state," ",t.zip_code,", USA"]})]})]}),(0,x.jsx)("td",{className:"align-middle",children:t.type_of_work_name}),(0,x.jsx)("td",{className:"align-middle",children:(0,x.jsx)(r.A.Select,{required:!0,name:"status_id",style:{backgroundColor:t.status_color,color:"white"},onChange:async e=>{const s=e.target.value;await _(t.id,s),A()},children:e.map((e=>(0,x.jsx)("option",{style:{backgroundColor:e.color},selected:e.id===t.status_id,value:e.id,children:e.name})))})}),(0,x.jsx)("td",{className:"align-middle text-end",children:(0,x.jsx)(m.A,{id:t.id,note:t.note,filterHouses:A})})]},t.id)))})]})]},s)}))]})}},9204:(e,t,s)=>{s.d(t,{X:()=>r});var a=s(4131),c=s(9722);const n=s(8478).x+"/api/status",r=(0,a.v)(((e,t)=>({statuses:[],loading:!1,error:null,status:{id:0,name:"",created_at:"",active:!0,sort:500,color:""},fetchStatus:async t=>{e({loading:!0,error:null});try{const s=await c.A.get(n+"/"+t);e({status:s.data,loading:!1})}catch(s){e({error:s.message,loading:!1})}},fetchStatuses:async()=>{e({loading:!0,error:null});try{const t=await c.A.get(n);e({statuses:t.data,loading:!1})}catch(t){e({error:t.message,loading:!1})}},fetchActiveStatuses:async()=>{e({loading:!0,error:null});try{const t=await c.A.get(n+"/active");e({statuses:t.data,loading:!1})}catch(t){e({error:t.message,loading:!1})}},addStatus:async s=>{e({loading:!0,error:null});try{await c.A.post(n,s),await t().fetchStatuses()}catch(a){e({error:a.message})}e({loading:!1})},updateStatus:async s=>{e({loading:!0,error:null});try{await c.A.put(n+"/"+s.id,s),await t().fetchStatuses()}catch(a){e({error:a.message})}e({loading:!1})},deleteStatus:async s=>{e({loading:!0,error:null});try{await c.A.delete("".concat(n,"/").concat(s)),await t().fetchStatuses()}catch(a){e({error:a.message})}e({loading:!1})}})))}}]);
//# sourceMappingURL=975.732daf57.chunk.js.map